# 故障排查 Skill

帮助用户解决爬虫运行中的问题。

## 常见问题

### 1. 爬取失败

**症状**：章节内容获取失败

**排查步骤**：
1. 启用调试模式查看 HTML 结构
2. 检查 CSS 选择器是否正确
3. 查看日志中的错误信息
4. 验证网站是否可访问

### 2. 章节顺序错乱

**症状**：TXT 文件中章节顺序不对

**原因**：标题规范化问题

**解决**：
- 检查 `normalize_chapter_title()` 的输出
- 确保章节链接按 URL 排序
- 验证章节列表的获取顺序

### 3. 被网站封禁

**症状**：大量请求失败，状态码 403/429

**解决**：
- 增加延迟时间：修改 `random_delay()` 参数
- 更换 User-Agent
- 减少并发（如果有）

### 4. 断点续爬不生效

**症状**：重新爬取已下载的章节

**排查**：
- 检查 JSON 文件是否存在
- 验证标题规范化是否一致
- 查看日志中的"已加载现有数据"信息

## 调试技巧

```bash
# 单章测试（限制章节数）
python run_crawler.py 77shuwu --max_chapters 1 --debug_enabled true

# 查看详细日志
# 在代码中添加 logger.info() 调试信息
```

## 日志分析

关键日志信息：
- `已加载现有数据，共X章` - 断点续爬状态
- `需要爬取 X 个章节` - 待爬取数量
- `爬取失败 (第 N/3 次尝试)` - 重试信息
- `达到最大重试次数` - 章节放弃
